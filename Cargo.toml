[package]
name = "mozjpeg-oxide"
version = "0.1.0"
edition = "2021"
rust-version = "1.70.0"
license = "BSD-3-Clause"
repository = "https://github.com/imazen/mozjpeg-oxide"
description = "Pure Rust JPEG encoder based on Mozilla's mozjpeg with trellis quantization"
homepage = "https://github.com/imazen/mozjpeg-oxide"
documentation = "https://docs.rs/mozjpeg-oxide"
readme = "README.md"
keywords = ["jpeg", "encoder", "mozjpeg", "compression", "image"]
categories = ["encoding", "multimedia::images"]
exclude = [
    "benchmark/",
    "corpus/",
    "crates/",
    "scripts/",
    "comparison_outputs/",
    ".github/",
    "tests/images/*.png",
]

[workspace]
members = ["crates/*"]

[features]
default = []
simd = []  # Enable explicit SIMD intrinsics for x86_64
# Enable PNG loading in corpus module (enabled by default in dev)
png = ["dep:png"]

[dependencies]
bytemuck = "1.14"
# Optional PNG support for corpus loading
png = { version = "0.17", optional = true }
wide = "1.1.1"

[dev-dependencies]
dssim = "3.2"
rgb = "0.8"
ssimulacra2 = "0.5"
png = "0.17"
proptest = "1.4"
criterion = "0.5"
jpeg-decoder = "0.3"
libc = "0.2"
# Use existing mozjpeg-sys from crates.io for basic FFI validation
mozjpeg-sys = "2.2"
# Codec testing infrastructure (provides DSSIM, SSIMULACRA2, Butteraugli metrics)
codec-eval = { git = "https://github.com/imazen/codec-eval" }
# Note: sys-local is NOT included in dev-dependencies because it requires local
# mozjpeg C source. To run ffi_comparison tests, manually uncomment below:
# sys-local = { path = "crates/sys-local" }
# Butteraugli perceptual image quality metric
butteraugli-oxide = "0.2"

[[bench]]
name = "encode"
harness = false
